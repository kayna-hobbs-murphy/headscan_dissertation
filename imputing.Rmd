---
title: "imputing"
output:
  word_document: default
  html_document: default
date: "2022-09-07"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
library(tidyverse)
library(flextable)
library(readxl)
library(extrafont)
library(missMDA)
library(psych)
```

```{r table-function}
#times new roman tables
my_ft_theme <- function(ft, ...) {
  # Remove vertical cell padding
  ft <- padding(ft, padding.top = 0, padding.bottom = 0, part = "all")
  
  # Change font to TNR 11
  ft <- font(ft, fontname = "Times New Roman", part = "all")
  ft <- fontsize(ft, part = "all", size = 12)
  ft
}
```

```{r}

headscan_full1<-read_excel("C:\\Users\\19177\\OneDrive - Colostate\\Desktop\\Dissertation\\headscan_dissertation\\headscan_full1.xlsx")

headscan_num <- select_if(headscan_full1, is.numeric)
headscan_num <- subset(headscan_num, select= -age)
str(headscan_num)
```

```{r}
res.comp <- imputePCA(headscan_num, ncp=2)
imputed <- as.data.frame(res.comp$completeObs)
imputed <- round(imputed, 0)
```


```{r}
summary(headscan_num)
headscan_stats <- describe(headscan_num)

headscan_stats1 <- headscan_stats
headscan_stats1$na <- 2016 - headscan_stats1$n
headscan_stats1 <- rownames_to_column(headscan_stats1, "measure")
```


```{r}
AA_C_sum <- headscan_num %>% 
  summarise(percent5th = quantile(AA_C, 0.05, na.rm=TRUE),
            percent25th = quantile(AA_C, 0.25, na.rm=TRUE),
            percent50th = quantile(AA_C, 0.50, na.rm=TRUE),
            percent75th = quantile(AA_C, 0.75, na.rm=TRUE),
            percent95th = quantile(AA_C, 0.95, na.rm=TRUE))
AA_C_sum$measure <- "AA_C"


BGl_C_sum <- headscan_num %>% 
  summarise(percent5th = quantile(BGl_C, 0.05, na.rm=TRUE),
            percent25th = quantile(BGl_C, 0.25, na.rm=TRUE),
            percent50th = quantile(BGl_C, 0.50, na.rm=TRUE),
            percent75th = quantile(BGl_C, 0.75, na.rm=TRUE),
            percent95th = quantile(BGl_C, 0.95, na.rm=TRUE))
BGl_C_sum$measure <- "BGl_C"

BiW_C_sum <- headscan_num %>% 
  summarise(percent5th = quantile(BiW_C, 0.05, na.rm=TRUE),
            percent25th = quantile(BiW_C, 0.25, na.rm=TRUE),
            percent50th = quantile(BiW_C, 0.50, na.rm=TRUE),
            percent75th = quantile(BiW_C, 0.75, na.rm=TRUE),
            percent95th = quantile(BiW_C, 0.95, na.rm=TRUE))
BiW_C_sum$measure <- "BiW_C"

BiW_L_sum <- headscan_num %>% 
  summarise(percent5th = quantile(BiW_L, 0.05, na.rm=TRUE),
            percent25th = quantile(BiW_L, 0.25, na.rm=TRUE),
            percent50th = quantile(BiW_L, 0.50, na.rm=TRUE),
            percent75th = quantile(BiW_L, 0.75, na.rm=TRUE),
            percent95th = quantile(BiW_L, 0.95, na.rm=TRUE))
BiW_L_sum$measure <- "BiW_L"

ChCh_C_sum <- headscan_num %>% 
  summarise(percent5th = quantile(ChCh_C, 0.05, na.rm=TRUE),
            percent25th = quantile(ChCh_C, 0.25, na.rm=TRUE),
            percent50th = quantile(ChCh_C, 0.50, na.rm=TRUE),
            percent75th = quantile(ChCh_C, 0.75, na.rm=TRUE),
            percent95th = quantile(ChCh_C, 0.95, na.rm=TRUE))
ChCh_C_sum$measure <- "ChCh_C"

GoSub_C_sum <- headscan_num %>% 
  summarise(percent5th = quantile(GoSub_C, 0.05, na.rm=TRUE),
            percent25th = quantile(GoSub_C, 0.25, na.rm=TRUE),
            percent50th = quantile(GoSub_C, 0.50, na.rm=TRUE),
            percent75th = quantile(GoSub_C, 0.75, na.rm=TRUE),
            percent95th = quantile(GoSub_C, 0.95, na.rm=TRUE))
GoSub_C_sum$measure <- "GoSub"

NRB_L_sum <- headscan_num %>% 
  summarise(percent5th = quantile(NRB_L, 0.05, na.rm=TRUE),
            percent25th = quantile(NRB_L, 0.25, na.rm=TRUE),
            percent50th = quantile(NRB_L, 0.50, na.rm=TRUE),
            percent75th = quantile(NRB_L, 0.75, na.rm=TRUE),
            percent95th = quantile(NRB_L, 0.95, na.rm=TRUE))
NRB_L_sum$measure <- "NRB_L"

ProA_L_sum <- headscan_num %>% 
  summarise(percent5th = quantile(ProA_L, 0.05, na.rm=TRUE),
            percent25th = quantile(ProA_L, 0.25, na.rm=TRUE),
            percent50th = quantile(ProA_L, 0.50, na.rm=TRUE),
            percent75th = quantile(ProA_L, 0.75, na.rm=TRUE),
            percent95th = quantile(ProA_L, 0.95, na.rm=TRUE))
ProA_L_sum$measure <- "ProA_L"

ChCh_C_sum <- headscan_num %>% 
  summarise(percent5th = quantile(ChCh_C, 0.05, na.rm=TRUE),
            percent25th = quantile(ChCh_C, 0.25, na.rm=TRUE),
            percent50th = quantile(ChCh_C, 0.50, na.rm=TRUE),
            percent75th = quantile(ChCh_C, 0.75, na.rm=TRUE),
            percent95th = quantile(ChCh_C, 0.95, na.rm=TRUE))
ChCh_C_sum$measure <- "ChCh_C"
```



```{r}
#headscan_stats1 <- headscan_stats1[c()]

#Autofit Width Table TNR
flextable(headscan_stats1) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Non-imputed SumStats") %>% 
  fit_to_width(7.5) 
```

```{r}
summary(imputed)
```



