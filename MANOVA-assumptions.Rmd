---
title: "MANOVA assumptions"
output: html_document
date: "2022-08-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
library(tidyverse)
library(readxl)
library(officer)
library(flextable)
library(extrafont)
library(writexl)
library(rstatix)
library(corrr)
library(corrplot)
library(car)
```

```{r}
#times new roman tables
my_ft_theme <- function(ft, ...) {
  # Remove vertical cell padding
  ft <- padding(ft, padding.top = 0, padding.bottom = 0, part = "all")
  
  # Change font to TNR 11
  ft <- font(ft, fontname = "Times New Roman", part = "all")
  ft <- fontsize(ft, part = "all", size = 12)
  ft
}
```



```{r}
SA3_noout <- read_excel("C:\\Users\\19177\\OneDrive - Colostate\\Desktop\\Dissertation\\headscan_dissertation\\SA3_noout.xlsx")
```


```{r}
str(SA3_noout)
SA3_num <- select_if(SA3_noout, is.numeric)
```


```{r}
correl <- correlate(SA3_num)
correl
```


```{r, fig.height=6, fig.width=8}
correl2 <- cor(SA3_num)
symnum(correl2)
corrplot(correl2, method = 'number')
```





checking assumptions using random variable: no transformation

```{r}
#make a random variable
#any number over 2 in place of 10
random <- rchisq(nrow(SA3_noout), 10)
#run a fake regression
fake <- lm(random~., data=SA3_noout[ , -1])
#create standardized residuals 
standardized <- rstandard(fake)
#create the fitted values 
fitted <- fake$fitted.values
```

```{r}
#homogeneity
#plot(fitted, standardized)
#abline(0,0)
#abline(v = 0)

#linearity
#qqnorm(standardized)
#abline(0,1)

#Normality
#hist(standardized)
```

```{r}
#creating dataframe for ggplot
temp1 <- data.frame(fitted, standardized)
str(temp1)
```

```{r}
 ggplot(data=temp1, aes(x=fitted, y=standardized))+
  geom_point(shape=1)+
  geom_hline(yintercept=0)+  
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="Residuals vs. Fitted Values of Randomly Generated Variable",
       subtitle = "No Data Transformation",
       y= "Standardized Residuals",
       x= "Fitted Values")

ggplot(data=temp1, aes(sample=standardized))+
  stat_qq()+
  stat_qq_line()+
  scale_x_continuous(n.breaks = 7)+
  #xlim(-3.5,3.5)+
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="QQPlot of Randomly Generated Variable",
       subtitle = "No Data Transformation",
       y= "Sample Quantiles",
       x= "Theoretical Quantities")

ggplot(data=temp1, aes(x=standardized))+
  geom_bar(stat="bin", bins=20, color= "black", fill = "white")+
  theme_bw()+theme(text=element_text(family= "Times New Roman"))+
  labs(title="Normality of Randomly Generated Variable",
       subtitle = "No Data Transformation",
       y= "Count",
       x= "Standardized Residuals")
```







checking assumptions using random variable: log base 10 transformation

```{r}
#make a random variable
#any number over 2 in place of 7
randomlog10 <- rchisq(nrow(SA3_noout), 10)
#run a fake regression
fakelog10 <- lm(log(randomlog10, base=10)~., data=SA3_noout[ , -1])
#create standardized residuals 
standardizedlog10 <- rstandard(fakelog10)
#create the fitted values 
fittedlog10 <- fakelog10$fitted.values
```

```{r}
#homogeneity (unscaled)
#plot(fakelog10$fitted.values, standardizedlog10)
#abline(0,0)
#abline(v = 0)

##homogeneity (scaled)
#plot(fittedlog10, standardizedlog10)
#abline(0,0)
#abline(v = 0)

#linearity
#qqnorm(standardizedlog10)
#abline(0,1)

#Normality
#hist(standardizedlog10)


```
```{r}
#creating dataframe for ggplot
temp2 <- data.frame(fittedlog10, standardizedlog10)
str(temp2)
```

```{r}
 ggplot(data=temp2, aes(x=fittedlog10, y=standardizedlog10))+
  geom_point(shape=1)+
  geom_hline(yintercept=0)+  
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="Residuals vs. Fitted Values of Randomly Generated Variable",
       subtitle = "Log Base 10 Transformation",
       y= "Standardized Residuals",
       x= "Fitted Values")

ggplot(data=temp2, aes(sample=standardizedlog10))+
  stat_qq()+
  stat_qq_line()+
  scale_x_continuous(n.breaks = 7)+
  #xlim(-3.5,3.5)+
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="QQPlot of Randomly Generated Variable",
       subtitle = "Log Base 10 Transformation",
       y= "Sample Quantiles",
       x= "Theoretical Quantities")

ggplot(data=temp2, aes(x=standardizedlog10))+
  geom_bar(stat="bin", bins=20, color= "black", fill = "white")+
  theme_bw()+theme(text=element_text(family= "Times New Roman"))+
  labs(title="Normality of Randomly Generated Variable",
       subtitle = "Log Base 10 Transformation",
       y= "Count",
       x= "Standardized Residuals")
```


checking assumptions using random variable: log base 10 transformation

```{r}
#make a random variable
#any number over 2 in place of 7
randomlog <- rchisq(nrow(SA3_noout), 10)
#run a fake regression
fakelog <- lm(log(randomlog)~., data=SA3_noout[ , -1])
#create standardized residuals 
standardizedlog <- rstandard(fakelog)
#create the fitted values 
fittedlog <- fakelog$fitted.values
```

```{r}
#homogeneity (unscaled)
#plot(fakelog$fitted.values, standardizedlog)
#abline(0,0)
#abline(v = 0)

##homogeneity (scaled)
#plot(fittedlog, standardizedlog)
#abline(0,0)
#abline(v = 0)

#linearity
#qqnorm(standardizedlog)
#abline(0,1)

#Normality
#hist(standardizedlog)

```
```{r}
#creating dataframe for ggplot
temp3 <- data.frame(fittedlog, standardizedlog)
str(temp3)
```

```{r}
 ggplot(data=temp3, aes(x=fittedlog, y=standardizedlog))+
  geom_point(shape=1)+
  geom_hline(yintercept=0)+  
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="Residuals vs. Fitted Values of Randomly Generated Variable",
       subtitle = "Log e Transformation",
       y= "Standardized Residuals",
       x= "Fitted Values")

ggplot(data=temp3, aes(sample=standardizedlog))+
  stat_qq()+
  stat_qq_line()+
  scale_x_continuous(n.breaks = 7)+
  #xlim(-3.5,3.5)+
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="QQPlot of Randomly Generated Variable",
       subtitle = "Log e Transformation",
       y= "Sample Quantiles",
       x= "Theoretical Quantities")

ggplot(data=temp3, aes(x=standardizedlog))+
  geom_bar(stat="bin", bins=20, color= "black", fill = "white")+
  theme_bw()+theme(text=element_text(family= "Times New Roman"))+
  labs(title="Normality of Randomly Generated Variable",
       subtitle = "Log e Transformation",
       y= "Count",
       x= "Standardized Residuals")
```




checking assumptions using random variable: sqrt transformation

```{r}
#make a random variable
#any number over 2 in place of 7
randomsqrt <- rchisq(nrow(SA3_noout), 10)
#run a fake regression
fakesqrt <- lm(sqrt(randomsqrt)~., data=SA3_noout[ , -1])
#create standardized residuals 
standardizedsqrt <- rstandard(fakesqrt)
#create the fitted values 
fittedsqrt <- fakesqrt$fitted.values
```

```{r}
#homogeneity (unscaled)
#plot(fakesqrt$fitted.values, standardizedsqrt)
#abline(0,0)
#abline(v = 0)

##homogeneity (scaled)
#plot(fittedsqrt, standardizedsqrt)
#abline(0,0)
#abline(v = 0)

#linearity
#qqnorm(standardizedsqrt)
#abline(0,1)

#Normality
#hist(standardizedsqrt)


```

```{r}
#creating dataframe for ggplot
temp4 <- data.frame(fittedsqrt, standardizedsqrt)
str(temp4)
```

```{r}
 ggplot(data=temp4, aes(x=fittedsqrt, y=standardizedsqrt))+
  geom_point(shape=1)+
  geom_hline(yintercept=0)+  
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="Residuals vs. Fitted Values of Randomly Generated Variable",
       subtitle = "Square Root Transformation",
       y= "Standardized Residuals",
       x= "Fitted Values")

ggplot(data=temp4, aes(sample=standardizedsqrt))+
  stat_qq()+
  stat_qq_line()+
  scale_x_continuous(n.breaks = 7)+
  #xlim(-3.5,3.5)+
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="QQPlot of Randomly Generated Variable",
       subtitle = "Square Root Transformation",
       y= "Sample Quantiles",
       x= "Theoretical Quantities")

ggplot(data=temp4, aes(x=standardizedsqrt))+
  geom_bar(stat="bin", bins=20, color= "black", fill = "white")+
  theme_bw()+theme(text=element_text(family= "Times New Roman"))+
  labs(title="Normality of Randomly Generated Variable",
       subtitle = "Square Root Transformation",
       y= "Count",
       x= "Standardized Residuals")
```




Checking for influencial measures in random sqrt transformation dataset

```{r}
#influencial observations (STAR 513: Lecture 5 examples)
# overwhelming to look at
inf_out <- influence.measures(fakesqrt)
# check out Cook's D (column 6)
sum(inf_out$is.inf[, 6])
```






Checking assumptions on actual MANOVA model: setup

```{r}
variables <- cbind(SA3_noout$AA_C, SA3_noout$BiW_C, SA3_noout$BiW_L, 
                   SA3_noout$GoSub_C, SA3_noout$NRB_L, SA3_noout$ProS_L,
                   SA3_noout$SelP_L, SA3_noout$SelM_L, SA3_noout$SnasM_C,
                   SA3_noout$SnasM_C, SA3_noout$TrSman_C, SA3_noout$TrTr_C,
                   SA3_noout$TrTr_L)


#part of Dr. Erin Buchanan's lecture, but Manova code returns error: Error in Anova.mlm(mod, ...) : model is singular
#lm_notransf <- lm(variables ~ gender*race_eth*age_group, data=SA3_noout,
                  #contrasts = list(gender=contr.sum, 
                                   #race_eth=contr.sum,
                                   #age_group=contr.sum))

#manova_notransf <- Manova(lm_notransf, type = "III")

```



Checking assumptions on actual MANOVA model: no transformation

```{r}



manova_out_nt <- manova(variables ~ gender*race_eth*age_group, data=SA3_noout)
fitted1 <- manova_out_nt$fitted.values
resid1 <- rstandard(manova_out_nt)

#homogeneity (unscaled)
#plot(fitted1, resid1)
#abline(0,0)
#abline(v = 0)

#linearity
#qqnorm(resid1)
#abline(0,1, lty=2)

#normality
#hist(resid1)
```


```{r}
#creating dataframe for ggplot
fitted1.1 <- as.data.frame(fitted1)
resid1.1 <-as.data.frame(resid1)

fitted1.1 <- rownames_to_column(fitted1.1, "scan_num")

fitted1.1 <- pivot_longer(fitted1.1, V1:V13, names_to = "variable", values_to = "fitted_vals")


resid1.1 <- rownames_to_column(resid1.1, "scan_num")

resid1.1 <- pivot_longer(resid1.1, V1:V13, names_to = "variable", values_to = "resid_vals")



temp5 <- full_join(fitted1.1, resid1.1, by=c('scan_num', 'variable'))
str(temp5)
```

```{r}
ggplot(data=temp5, aes(x=fitted_vals, y=resid_vals))+
  geom_point(shape=1)+
  geom_hline(yintercept=0)+  
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="Residuals vs. Fitted Values of Manova Model",
       subtitle = "No Transformation",
       y= "Standardized Residuals",
       x= "Fitted Values")

ggplot(data=temp5, aes(sample=resid_vals))+
  stat_qq()+
  stat_qq_line()+
  scale_x_continuous(n.breaks = 7)+
  #xlim(-3.5,3.5)+
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="QQPlot of Manova Model",
       subtitle = "No Transformation",
       y= "Sample Quantiles",
       x= "Theoretical Quantities")

ggplot(data=temp5, aes(x=resid_vals))+
  geom_bar(stat="bin", bins=20, color= "black", fill = "white")+
  theme_bw()+theme(text=element_text(family= "Times New Roman"))+
  labs(title="Normality of Manova Model",
       subtitle = "No Transformation",
       y= "Count",
       x= "Standardized Residuals")
```








Checking assumptions on actual MANOVA model: log base 10 transformation

```{r}

manova_out_log10 <- manova(log(variables, base=10) ~ gender*race_eth*age_group, data=SA3_noout)


fitted1_log10 <- manova_out_log10$fitted.values

resid1_log10 <- rstandard(manova_out_log10)


#homogeneity 
#plot(fitted1_log10, resid1_log10)
#abline(0,0)
#abline(v = 0)

#linearity
#qqnorm(resid1_log10)
#abline(0,1, lty=2)

#normality
#hist(resid1_log10)
```

```{r}
#creating dataframe for ggplot
fitted2.1 <- as.data.frame(fitted1_log10)
resid2.1 <-as.data.frame(resid1_log10)

fitted2.1 <- rownames_to_column(fitted2.1, "scan_num")

fitted2.1 <- pivot_longer(fitted2.1, V1:V13, names_to = "variable", values_to = "fitted_vals")


resid2.1 <- rownames_to_column(resid2.1, "scan_num")

resid2.1 <- pivot_longer(resid2.1, V1:V13, names_to = "variable", values_to = "resid_vals")



temp6 <- full_join(fitted2.1, resid2.1, by=c('scan_num', 'variable'))
str(temp6)
```

```{r}
ggplot(data=temp6, aes(x=fitted_vals, y=resid_vals))+
  geom_point(shape=1)+
  geom_hline(yintercept=0)+  
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="Residuals vs. Fitted Values of Manova Model",
       subtitle = "Log Base 10 Transformation",
       y= "Standardized Residuals",
       x= "Fitted Values")

ggplot(data=temp6, aes(sample=resid_vals))+
  stat_qq()+
  stat_qq_line()+
  scale_x_continuous(n.breaks = 7)+
  #xlim(-3.5,3.5)+
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="QQPlot of Manova Model",
       subtitle = "Log Base 10 Transformation",
       y= "Sample Quantiles",
       x= "Theoretical Quantities")

ggplot(data=temp5, aes(x=resid_vals))+
  geom_bar(stat="bin", bins=20, color= "black", fill = "white")+
  theme_bw()+theme(text=element_text(family= "Times New Roman"))+
  labs(title="Normality of Manova Model",
       subtitle = "Log Base 10 Transformation",
       y= "Count",
       x= "Standardized Residuals")
```




Checking assumptions on actual MANOVA model: log transformation

```{r}

manova_out_log <- manova(log(variables) ~ gender*race_eth*age_group, data=SA3_noout)


fitted1_log <- manova_out_log$fitted.values

resid1_log <- rstandard(manova_out_log)


#homogeneity
#plot(fitted1_log, resid1_log)
#abline(0,0)
#abline(v = 0)

#linearity
#qqnorm(resid1_log)
#abline(0,1, lty=2)

#normality
#hist(resid1_log)
```

```{r}
#creating dataframe for ggplot
fitted3.1 <- as.data.frame(fitted1_log)
resid3.1 <-as.data.frame(resid1_log)

fitted3.1 <- rownames_to_column(fitted3.1, "scan_num")

fitted3.1 <- pivot_longer(fitted3.1, V1:V13, names_to = "variable", values_to = "fitted_vals")


resid3.1 <- rownames_to_column(resid3.1, "scan_num")

resid3.1 <- pivot_longer(resid3.1, V1:V13, names_to = "variable", values_to = "resid_vals")



temp7 <- full_join(fitted3.1, resid3.1, by=c('scan_num', 'variable'))
str(temp7)
```

```{r}
ggplot(data=temp7, aes(x=fitted_vals, y=resid_vals))+
  geom_point(shape=1)+
  geom_hline(yintercept=0)+  
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="Residuals vs. Fitted Values of Manova Model",
       subtitle = "Log e Transformation",
       y= "Standardized Residuals",
       x= "Fitted Values")

ggplot(data=temp7, aes(sample=resid_vals))+
  stat_qq()+
  stat_qq_line()+
  scale_x_continuous(n.breaks = 7)+
  #xlim(-3.5,3.5)+
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="QQPlot of Manova Model",
       subtitle = "Log e Transformation",
       y= "Sample Quantiles",
       x= "Theoretical Quantities")

ggplot(data=temp7, aes(x=resid_vals))+
  geom_bar(stat="bin", bins=20, color= "black", fill = "white")+
  theme_bw()+theme(text=element_text(family= "Times New Roman"))+
  labs(title="Normality of Manova Model",
       subtitle = "Log e Transformation",
       y= "Count",
       x= "Standardized Residuals")
```




Checking assumptions on actual MANOVA model: sqrt transformation

```{r}

manova_out_sqrt <- manova(sqrt(variables) ~ gender*race_eth*age_group, data=SA3_noout)

fitted1_sqrt <- manova_out_sqrt$fitted.values

resid1_sqrt <- rstandard(manova_out_sqrt)

#homogeneity 
#plot(fitted1_sqrt, resid1_sqrt)
#abline(0,0)
#abline(v = 0)

#linearity
#qqnorm(resid1_sqrt)
#abline(0,1, lty=2)

#normality
#hist(resid1_sqrt)
```

```{r}
#creating dataframe for ggplot
fitted4.1 <- as.data.frame(fitted1_sqrt)
resid4.1 <-as.data.frame(resid1_sqrt)

fitted4.1 <- rownames_to_column(fitted4.1, "scan_num")

fitted4.1 <- pivot_longer(fitted4.1, V1:V13, names_to = "variable", values_to = "fitted_vals")


resid4.1 <- rownames_to_column(resid4.1, "scan_num")

resid4.1 <- pivot_longer(resid4.1, V1:V13, names_to = "variable", values_to = "resid_vals")



temp8 <- full_join(fitted4.1, resid4.1, by=c('scan_num', 'variable'))
str(temp8)
```

```{r}
ggplot(data=temp8, aes(x=fitted_vals, y=resid_vals))+
  geom_point(shape=1)+
  geom_hline(yintercept=0)+  
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="Residuals vs. Fitted Values of Manova Model",
       subtitle = "Square Root Transformation",
       y= "Standardized Residuals",
       x= "Fitted Values")

ggplot(data=temp8, aes(sample=resid_vals))+
  stat_qq()+
  stat_qq_line()+
  scale_x_continuous(n.breaks = 7)+
  #xlim(-3.5,3.5)+
  theme_bw()+
  theme(text=element_text(family= "Times New Roman"))+
  labs(title="QQPlot of Manova Model",
       subtitle = "Square Root Transformation",
       y= "Sample Quantiles",
       x= "Theoretical Quantities")

ggplot(data=temp8, aes(x=resid_vals))+
  geom_bar(stat="bin", bins=20, color= "black", fill = "white")+
  theme_bw()+theme(text=element_text(family= "Times New Roman"))+
  labs(title="Normality of Manova Model",
       subtitle = "Square Root Transformation",
       y= "Count",
       x= "Standardized Residuals")
```









Levene's test, no transformation

```{r}

AA_C_levene <- leveneTest(AA_C ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
AA_C_levene <- rownames_to_column(AA_C_levene, "X")
AA_C_levene$measure <-"AA_C"
AA_C_levene <- AA_C_levene[-c(1)]
AA_C_levene <- AA_C_levene[-c(2),]


BiW_C_levene <- leveneTest(BiW_C ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
BiW_C_levene <- rownames_to_column(BiW_C_levene, "X")
BiW_C_levene$measure <-"BiW_C"
BiW_C_levene <- BiW_C_levene[-c(1)]
BiW_C_levene <- BiW_C_levene[-c(2),]


BiW_L_levene <- leveneTest(BiW_L ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
BiW_L_levene <- rownames_to_column(BiW_L_levene, "X")
BiW_L_levene$measure <-"BiW_L"
BiW_L_levene <- BiW_L_levene[-c(1)]
BiW_L_levene <- BiW_L_levene[-c(2),]


GoSub_C_levene <- leveneTest(GoSub_C ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
GoSub_C_levene <- rownames_to_column(GoSub_C_levene, "X")
GoSub_C_levene$measure <-"GoSub_C"
GoSub_C_levene <- GoSub_C_levene[-c(1)]
GoSub_C_levene <- GoSub_C_levene[-c(2),]


NRB_L_levene <- leveneTest(NRB_L ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
NRB_L_levene <- rownames_to_column(NRB_L_levene, "X")
NRB_L_levene$measure <-"NRB_L"
NRB_L_levene <- NRB_L_levene[-c(1)]
NRB_L_levene <- NRB_L_levene[-c(2),]


ProS_L_levene <- leveneTest(ProS_L ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
ProS_L_levene <- rownames_to_column(ProS_L_levene, "X")
ProS_L_levene$measure <-"ProS_L"
ProS_L_levene <- ProS_L_levene[-c(1)]
ProS_L_levene <- ProS_L_levene[-c(2),]


SelP_L_levene <- leveneTest(SelP_L ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SelP_L_levene <- rownames_to_column(SelP_L_levene, "X")
SelP_L_levene$measure <-"SelP_L"
SelP_L_levene <- SelP_L_levene[-c(1)]
SelP_L_levene <- SelP_L_levene[-c(2),]


SelM_L_levene <- leveneTest(SelM_L ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SelM_L_levene <- rownames_to_column(SelM_L_levene, "X")
SelM_L_levene$measure <-"SelM_L"
SelM_L_levene <- SelM_L_levene[-c(1)]
SelM_L_levene <- SelM_L_levene[-c(2),]


SnasM_C_levene <- leveneTest(SnasM_C ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SnasM_C_levene <- rownames_to_column(SnasM_C_levene, "X")
SnasM_C_levene$measure <-"SnasM_C"
SnasM_C_levene <- SnasM_C_levene[-c(1)]
SnasM_C_levene <- SnasM_C_levene[-c(2),]


TrSman_C_levene <- leveneTest(TrSman_C ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrSman_C_levene <- rownames_to_column(TrSman_C_levene, "X")
TrSman_C_levene$measure <-"TrSman_C"
TrSman_C_levene <- TrSman_C_levene[-c(1)]
TrSman_C_levene <- TrSman_C_levene[-c(2),]


TrTr_C_levene <- leveneTest(TrTr_C ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrTr_C_levene <- rownames_to_column(TrTr_C_levene, "X")
TrTr_C_levene$measure <-"TrTr_C"
TrTr_C_levene <- TrTr_C_levene[-c(1)]
TrTr_C_levene <- TrTr_C_levene[-c(2),]


TrTr_L_levene <- leveneTest(TrTr_L ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrTr_L_levene <- rownames_to_column(TrTr_L_levene, "X")
TrTr_L_levene$measure <-"TrTr_L"
TrTr_L_levene <- TrTr_L_levene[-c(1)]
TrTr_L_levene <- TrTr_L_levene[-c(2),]

levene_data <- rbind(AA_C_levene, BiW_C_levene, BiW_L_levene, GoSub_C_levene, NRB_L_levene,
                     ProS_L_levene, SelP_L_levene, SelM_L_levene, SnasM_C_levene,
                     TrSman_C_levene, TrTr_C_levene, TrTr_L_levene)

levene_data <- levene_data[c(4,1,2,3)]

levene_data$p_val <- levene_data$`Pr(>F)`

levene_data$equal_var <- with(levene_data, ifelse(p_val < 0.05, 'FALSE', 'TRUE'))

levene_data <- levene_data[-c(5)]
```

```{r}
#Size 12 Table TNR
flextable(levene_data) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Levene's Test Values") 
#%>% set_header_labels(values = list(AA_C = "Alare/AlareCont"))

#Autofit Width Table TNR
flextable(levene_data) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Levene's Test Values") %>% 
  fit_to_width(7.5) 
#%>% set_header_labels(values = list(AA_C = "Alare/AlareCont"))
```



Levene's test, log base 10 transformation
```{r}

AA_C_levene10 <- leveneTest(log(AA_C , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
AA_C_levene10 <- rownames_to_column(AA_C_levene10, "X")
AA_C_levene10$measure <-"AA_C"
AA_C_levene10 <- AA_C_levene10[-c(1)]
AA_C_levene10 <- AA_C_levene10[-c(2),]


BiW_C_levene10 <- leveneTest(log(BiW_C , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
BiW_C_levene10 <- rownames_to_column(BiW_C_levene10, "X")
BiW_C_levene10$measure <-"BiW_C"
BiW_C_levene10 <- BiW_C_levene10[-c(1)]
BiW_C_levene10 <- BiW_C_levene10[-c(2),]


BiW_L_levene10 <- leveneTest(log(BiW_L , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
BiW_L_levene10 <- rownames_to_column(BiW_L_levene10, "X")
BiW_L_levene10$measure <-"BiW_L"
BiW_L_levene10 <- BiW_L_levene10[-c(1)]
BiW_L_levene10 <- BiW_L_levene10[-c(2),]


GoSub_C_levene10 <- leveneTest(log(GoSub_C , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
GoSub_C_levene10 <- rownames_to_column(GoSub_C_levene10, "X")
GoSub_C_levene10$measure <-"GoSub_C"
GoSub_C_levene10 <- GoSub_C_levene10[-c(1)]
GoSub_C_levene10 <- GoSub_C_levene10[-c(2),]


NRB_L_levene10 <- leveneTest(log(NRB_L , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
NRB_L_levene10 <- rownames_to_column(NRB_L_levene10, "X")
NRB_L_levene10$measure <-"NRB_L"
NRB_L_levene10 <- NRB_L_levene10[-c(1)]
NRB_L_levene10 <- NRB_L_levene10[-c(2),]


ProS_L_levene10 <- leveneTest(log(ProS_L , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
ProS_L_levene10 <- rownames_to_column(ProS_L_levene10, "X")
ProS_L_levene10$measure <-"ProS_L"
ProS_L_levene10 <- ProS_L_levene10[-c(1)]
ProS_L_levene10 <- ProS_L_levene10[-c(2),]


SelP_L_levene10 <- leveneTest(log(SelP_L , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SelP_L_levene10 <- rownames_to_column(SelP_L_levene10, "X")
SelP_L_levene10$measure <-"SelP_L"
SelP_L_levene10 <- SelP_L_levene10[-c(1)]
SelP_L_levene10 <- SelP_L_levene10[-c(2),]


SelM_L_levene10 <- leveneTest(log(SelM_L , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SelM_L_levene10 <- rownames_to_column(SelM_L_levene10, "X")
SelM_L_levene10$measure <-"SelM_L"
SelM_L_levene10 <- SelM_L_levene10[-c(1)]
SelM_L_levene10 <- SelM_L_levene10[-c(2),]


SnasM_C_levene10 <- leveneTest(log(SnasM_C , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SnasM_C_levene10 <- rownames_to_column(SnasM_C_levene10, "X")
SnasM_C_levene10$measure <-"SnasM_C"
SnasM_C_levene10 <- SnasM_C_levene10[-c(1)]
SnasM_C_levene10 <- SnasM_C_levene10[-c(2),]


TrSman_C_levene10 <- leveneTest(log(TrSman_C , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrSman_C_levene10 <- rownames_to_column(TrSman_C_levene10, "X")
TrSman_C_levene10$measure <-"TrSman_C"
TrSman_C_levene10 <- TrSman_C_levene10[-c(1)]
TrSman_C_levene10 <- TrSman_C_levene10[-c(2),]


TrTr_C_levene10 <- leveneTest(log(TrTr_C , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrTr_C_levene10 <- rownames_to_column(TrTr_C_levene10, "X")
TrTr_C_levene10$measure <-"TrTr_C"
TrTr_C_levene10 <- TrTr_C_levene10[-c(1)]
TrTr_C_levene10 <- TrTr_C_levene10[-c(2),]


TrTr_L_levene10 <- leveneTest(log(TrTr_L , base=10) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrTr_L_levene10 <- rownames_to_column(TrTr_L_levene10, "X")
TrTr_L_levene10$measure <-"TrTr_L"
TrTr_L_levene10 <- TrTr_L_levene10[-c(1)]
TrTr_L_levene10 <- TrTr_L_levene10[-c(2),]

levene_data10 <- rbind(AA_C_levene10, BiW_C_levene10, BiW_L_levene10, GoSub_C_levene10, NRB_L_levene10,
                     ProS_L_levene10, SelP_L_levene10, SelM_L_levene10, SnasM_C_levene10,
                     TrSman_C_levene10, TrTr_C_levene10, TrTr_L_levene10)

levene_data10 <- levene_data10[c(4,1,2,3)]

levene_data10$p_val <- levene_data10$`Pr(>F)`

levene_data10$equal_var <- with(levene_data10, ifelse(p_val < 0.05, 'FALSE', 'TRUE'))

levene_data10 <- levene_data10[-c(5)]
```


```{r}
#Size 12 Table TNR
flextable(levene_data10) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Levene's Test Values, Log Base 10 Transformation") 
#%>% set_header_labels(values = list(AA_C = "Alare/AlareCont"))

#Autofit Width Table TNR
flextable(levene_data10) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Levene's Test Values, Log Base 10 Transformation") %>% 
  fit_to_width(7.5) 
#%>% set_header_labels(values = list(AA_C = "Alare/AlareCont"))
```




Levene's test, log transformation

```{r}

AA_C_levene_e <- leveneTest(log(AA_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
AA_C_levene_e <- rownames_to_column(AA_C_levene_e, "X")
AA_C_levene_e$measure <-"AA_C"
AA_C_levene_e <- AA_C_levene_e[-c(1)]
AA_C_levene_e <- AA_C_levene_e[-c(2),]


BiW_C_levene_e <- leveneTest(log(BiW_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
BiW_C_levene_e <- rownames_to_column(BiW_C_levene_e, "X")
BiW_C_levene_e$measure <-"BiW_C"
BiW_C_levene_e <- BiW_C_levene_e[-c(1)]
BiW_C_levene_e <- BiW_C_levene_e[-c(2),]


BiW_L_levene_e <- leveneTest(log(BiW_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
BiW_L_levene_e <- rownames_to_column(BiW_L_levene_e, "X")
BiW_L_levene_e$measure <-"BiW_L"
BiW_L_levene_e <- BiW_L_levene_e[-c(1)]
BiW_L_levene_e <- BiW_L_levene_e[-c(2),]


GoSub_C_levene_e <- leveneTest(log(GoSub_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
GoSub_C_levene_e <- rownames_to_column(GoSub_C_levene_e, "X")
GoSub_C_levene_e$measure <-"GoSub_C"
GoSub_C_levene_e <- GoSub_C_levene_e[-c(1)]
GoSub_C_levene_e <- GoSub_C_levene_e[-c(2),]


NRB_L_levene_e <- leveneTest(log(NRB_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
NRB_L_levene_e <- rownames_to_column(NRB_L_levene_e, "X")
NRB_L_levene_e$measure <-"NRB_L"
NRB_L_levene_e <- NRB_L_levene_e[-c(1)]
NRB_L_levene_e <- NRB_L_levene_e[-c(2),]


ProS_L_levene_e <- leveneTest(log(ProS_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
ProS_L_levene_e <- rownames_to_column(ProS_L_levene_e, "X")
ProS_L_levene_e$measure <-"ProS_L"
ProS_L_levene_e <- ProS_L_levene_e[-c(1)]
ProS_L_levene_e <- ProS_L_levene_e[-c(2),]


SelP_L_levene_e <- leveneTest(log(SelP_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SelP_L_levene_e <- rownames_to_column(SelP_L_levene_e, "X")
SelP_L_levene_e$measure <-"SelP_L"
SelP_L_levene_e <- SelP_L_levene_e[-c(1)]
SelP_L_levene_e <- SelP_L_levene_e[-c(2),]


SelM_L_levene_e <- leveneTest(log(SelM_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SelM_L_levene_e <- rownames_to_column(SelM_L_levene_e, "X")
SelM_L_levene_e$measure <-"SelM_L"
SelM_L_levene_e <- SelM_L_levene_e[-c(1)]
SelM_L_levene_e <- SelM_L_levene_e[-c(2),]


SnasM_C_levene_e <- leveneTest(log(SnasM_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SnasM_C_levene_e <- rownames_to_column(SnasM_C_levene_e, "X")
SnasM_C_levene_e$measure <-"SnasM_C"
SnasM_C_levene_e <- SnasM_C_levene_e[-c(1)]
SnasM_C_levene_e <- SnasM_C_levene_e[-c(2),]


TrSman_C_levene_e <- leveneTest(log(TrSman_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrSman_C_levene_e <- rownames_to_column(TrSman_C_levene_e, "X")
TrSman_C_levene_e$measure <-"TrSman_C"
TrSman_C_levene_e <- TrSman_C_levene_e[-c(1)]
TrSman_C_levene_e <- TrSman_C_levene_e[-c(2),]


TrTr_C_levene_e <- leveneTest(log(TrTr_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrTr_C_levene_e <- rownames_to_column(TrTr_C_levene_e, "X")
TrTr_C_levene_e$measure <-"TrTr_C"
TrTr_C_levene_e <- TrTr_C_levene_e[-c(1)]
TrTr_C_levene_e <- TrTr_C_levene_e[-c(2),]


TrTr_L_levene_e <- leveneTest(log(TrTr_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrTr_L_levene_e <- rownames_to_column(TrTr_L_levene_e, "X")
TrTr_L_levene_e$measure <-"TrTr_L"
TrTr_L_levene_e <- TrTr_L_levene_e[-c(1)]
TrTr_L_levene_e <- TrTr_L_levene_e[-c(2),]

levene_data_e <- rbind(AA_C_levene_e, BiW_C_levene_e, BiW_L_levene_e, GoSub_C_levene_e, NRB_L_levene_e,
                     ProS_L_levene_e, SelP_L_levene_e, SelM_L_levene_e, SnasM_C_levene_e,
                     TrSman_C_levene_e, TrTr_C_levene_e, TrTr_L_levene_e)

levene_data_e <- levene_data_e[c(4,1,2,3)]

levene_data_e$p_val <- levene_data_e$`Pr(>F)`

levene_data_e$equal_var <- with(levene_data_e, ifelse(p_val < 0.05, 'FALSE', 'TRUE'))

levene_data_e <- levene_data_e[-c(5)]
```

```{r}
#Size 12 Table TNR
flextable(levene_data_e) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Levene's Test Values, Log e Transformation") 
#%>% set_header_labels(values = list(AA_C = "Alare/AlareCont"))

#Autofit Width Table TNR
flextable(levene_data_e) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Levene's Test Values, Log e Transformation") %>% 
  fit_to_width(7.5) 
#%>% set_header_labels(values = list(AA_C = "Alare/AlareCont"))
```





Levene's test, sqrt transformation

```{r}

AA_C_levenesqrt <- leveneTest(sqrt(AA_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
AA_C_levenesqrt <- rownames_to_column(AA_C_levenesqrt, "X")
AA_C_levenesqrt$measure <-"AA_C"
AA_C_levenesqrt <- AA_C_levenesqrt[-c(1)]
AA_C_levenesqrt <- AA_C_levenesqrt[-c(2),]


BiW_C_levenesqrt <- leveneTest(sqrt(BiW_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
BiW_C_levenesqrt <- rownames_to_column(BiW_C_levenesqrt, "X")
BiW_C_levenesqrt$measure <-"BiW_C"
BiW_C_levenesqrt <- BiW_C_levenesqrt[-c(1)]
BiW_C_levenesqrt <- BiW_C_levenesqrt[-c(2),]


BiW_L_levenesqrt <- leveneTest(sqrt(BiW_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
BiW_L_levenesqrt <- rownames_to_column(BiW_L_levenesqrt, "X")
BiW_L_levenesqrt$measure <-"BiW_L"
BiW_L_levenesqrt <- BiW_L_levenesqrt[-c(1)]
BiW_L_levenesqrt <- BiW_L_levenesqrt[-c(2),]


GoSub_C_levenesqrt <- leveneTest(sqrt(GoSub_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
GoSub_C_levenesqrt <- rownames_to_column(GoSub_C_levenesqrt, "X")
GoSub_C_levenesqrt$measure <-"GoSub_C"
GoSub_C_levenesqrt <- GoSub_C_levenesqrt[-c(1)]
GoSub_C_levenesqrt <- GoSub_C_levenesqrt[-c(2),]


NRB_L_levenesqrt <- leveneTest(sqrt(NRB_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
NRB_L_levenesqrt <- rownames_to_column(NRB_L_levenesqrt, "X")
NRB_L_levenesqrt$measure <-"NRB_L"
NRB_L_levenesqrt <- NRB_L_levenesqrt[-c(1)]
NRB_L_levenesqrt <- NRB_L_levenesqrt[-c(2),]


ProS_L_levenesqrt <- leveneTest(sqrt(ProS_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
ProS_L_levenesqrt <- rownames_to_column(ProS_L_levenesqrt, "X")
ProS_L_levenesqrt$measure <-"ProS_L"
ProS_L_levenesqrt <- ProS_L_levenesqrt[-c(1)]
ProS_L_levenesqrt <- ProS_L_levenesqrt[-c(2),]


SelP_L_levenesqrt <- leveneTest(sqrt(SelP_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SelP_L_levenesqrt <- rownames_to_column(SelP_L_levenesqrt, "X")
SelP_L_levenesqrt$measure <-"SelP_L"
SelP_L_levenesqrt <- SelP_L_levenesqrt[-c(1)]
SelP_L_levenesqrt <- SelP_L_levenesqrt[-c(2),]


SelM_L_levenesqrt <- leveneTest(sqrt(SelM_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SelM_L_levenesqrt <- rownames_to_column(SelM_L_levenesqrt, "X")
SelM_L_levenesqrt$measure <-"SelM_L"
SelM_L_levenesqrt <- SelM_L_levenesqrt[-c(1)]
SelM_L_levenesqrt <- SelM_L_levenesqrt[-c(2),]


SnasM_C_levenesqrt <- leveneTest(sqrt(SnasM_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
SnasM_C_levenesqrt <- rownames_to_column(SnasM_C_levenesqrt, "X")
SnasM_C_levenesqrt$measure <-"SnasM_C"
SnasM_C_levenesqrt <- SnasM_C_levenesqrt[-c(1)]
SnasM_C_levenesqrt <- SnasM_C_levenesqrt[-c(2),]


TrSman_C_levenesqrt <- leveneTest(sqrt(TrSman_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrSman_C_levenesqrt <- rownames_to_column(TrSman_C_levenesqrt, "X")
TrSman_C_levenesqrt$measure <-"TrSman_C"
TrSman_C_levenesqrt <- TrSman_C_levenesqrt[-c(1)]
TrSman_C_levenesqrt <- TrSman_C_levenesqrt[-c(2),]


TrTr_C_levenesqrt <- leveneTest(sqrt(TrTr_C) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrTr_C_levenesqrt <- rownames_to_column(TrTr_C_levenesqrt, "X")
TrTr_C_levenesqrt$measure <-"TrTr_C"
TrTr_C_levenesqrt <- TrTr_C_levenesqrt[-c(1)]
TrTr_C_levenesqrt <- TrTr_C_levenesqrt[-c(2),]


TrTr_L_levenesqrt <- leveneTest(sqrt(TrTr_L) ~ gender*race_eth*age_group, data=SA3_noout, center=mean)
TrTr_L_levenesqrt <- rownames_to_column(TrTr_L_levenesqrt, "X")
TrTr_L_levenesqrt$measure <-"TrTr_L"
TrTr_L_levenesqrt <- TrTr_L_levenesqrt[-c(1)]
TrTr_L_levenesqrt <- TrTr_L_levenesqrt[-c(2),]

levene_datasqrt <- rbind(AA_C_levenesqrt, BiW_C_levenesqrt, BiW_L_levenesqrt, GoSub_C_levenesqrt, NRB_L_levenesqrt,
                     ProS_L_levenesqrt, SelP_L_levenesqrt, SelM_L_levenesqrt, SnasM_C_levenesqrt,
                     TrSman_C_levenesqrt, TrTr_C_levenesqrt, TrTr_L_levenesqrt)

levene_datasqrt <- levene_datasqrt[c(4,1,2,3)]

levene_datasqrt$p_val <- levene_datasqrt$`Pr(>F)`

levene_datasqrt$equal_var <- with(levene_datasqrt, ifelse(p_val < 0.05, 'FALSE', 'TRUE'))

levene_datasqrt <- levene_datasqrt[-c(5)]
```

```{r}
#Size 12 Table TNR
flextable(levene_datasqrt) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Levene's Test Values, Square Root Transformation") 
#%>% set_header_labels(values = list(AA_C = "Alare/AlareCont"))

#Autofit Width Table TNR
flextable(levene_datasqrt) %>%
  my_ft_theme()%>% 
  bold(part = "header") %>% 
  set_caption("Levene's Test Values, Square Root Transformation") %>% 
  fit_to_width(7.5) 
#%>% set_header_labels(values = list(AA_C = "Alare/AlareCont"))
```




